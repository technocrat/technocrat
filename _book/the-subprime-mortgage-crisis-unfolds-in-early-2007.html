<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science Portfolio</title>
  <meta name="description" content="Landing site">
  <meta name="generator" content="bookdown 0.7.10 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science Portfolio" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Landing site" />
  <meta name="github-repo" content="github/technocrat/technocrat.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science Portfolio" />
  
  <meta name="twitter:description" content="Landing site" />
  

<meta name="author" content="Richard Careaga">


<meta name="date" content="2018-06-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="dectab.html">
<link rel="next" href="the-enron-email-corpus.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Purpose</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#updates"><i class="fa fa-check"></i><b>1.1</b> Updates</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#literate-programming-the-tight-integration-of-code-and-text"><i class="fa fa-check"></i><b>1.2</b> Literate programming: the tight integration of code and text</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i><b>1.3</b> Background</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#the-cases"><i class="fa fa-check"></i><b>1.4</b> The Cases</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#current-credentials"><i class="fa fa-check"></i><b>1.5</b> Current Credentials</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#graduate-school-level"><i class="fa fa-check"></i><b>1.5.1</b> Graduate school level</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#undergraduate-level"><i class="fa fa-check"></i><b>1.5.2</b> Undergraduate level</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#prior-analytic-and-programming-experience"><i class="fa fa-check"></i><b>1.6</b> Prior analytic and programming experience</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="counted.html"><a href="counted.html"><i class="fa fa-check"></i><b>2</b> 2015 Police Involved Homicides</a><ul>
<li class="chapter" data-level="2.1" data-path="counted.html"><a href="counted.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="counted.html"><a href="counted.html#the-data"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="counted.html"><a href="counted.html#tabular-summary-of-the-data"><i class="fa fa-check"></i><b>2.3</b> Tabular summary of the data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="counted.html"><a href="counted.html#gender"><i class="fa fa-check"></i><b>2.3.1</b> Gender</a></li>
<li class="chapter" data-level="2.3.2" data-path="counted.html"><a href="counted.html#raceethnicity"><i class="fa fa-check"></i><b>2.3.2</b> Race/Ethnicity</a></li>
<li class="chapter" data-level="2.3.3" data-path="counted.html"><a href="counted.html#age"><i class="fa fa-check"></i><b>2.3.3</b> Age</a></li>
<li class="chapter" data-level="2.3.4" data-path="counted.html"><a href="counted.html#cause-of-death"><i class="fa fa-check"></i><b>2.3.4</b> Cause of Death</a></li>
<li class="chapter" data-level="2.3.5" data-path="counted.html"><a href="counted.html#whether-and-how-civilians-were-armed"><i class="fa fa-check"></i><b>2.3.5</b> Whether and how civilians were armed</a></li>
<li class="chapter" data-level="2.3.6" data-path="counted.html"><a href="counted.html#location"><i class="fa fa-check"></i><b>2.3.6</b> Location</a></li>
<li class="chapter" data-level="2.3.7" data-path="counted.html"><a href="counted.html#months-and-days-of-death"><i class="fa fa-check"></i><b>2.3.7</b> Months and Days of Death</a></li>
<li class="chapter" data-level="2.3.8" data-path="counted.html"><a href="counted.html#cause-of-death-and-civilian-armed-status"><i class="fa fa-check"></i><b>2.3.8</b> Cause of Death and Civilian Armed Status</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="counted.html"><a href="counted.html#geographic-analysis-of-the-data"><i class="fa fa-check"></i><b>2.4</b> Geographic Analysis of the Data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="counted.html"><a href="counted.html#many-datasets-are-distributed-similarly-to-population"><i class="fa fa-check"></i><b>2.4.1</b> Many Datasets are Distributed Similarly to Population</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="counted.html"><a href="counted.html#what-conclusions-can-we-draw-from-the-short-national-summary"><i class="fa fa-check"></i><b>2.5</b> What conclusions can we draw from the short, national summary?</a><ul>
<li class="chapter" data-level="2.5.1" data-path="counted.html"><a href="counted.html#detail-underlying-deaths-of-women"><i class="fa fa-check"></i><b>2.5.1</b> Detail underlying deaths of women</a></li>
<li class="chapter" data-level="2.5.2" data-path="counted.html"><a href="counted.html#cautionary-example"><i class="fa fa-check"></i><b>2.5.2</b> Cautionary Example</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="counted.html"><a href="counted.html#next-steps"><i class="fa fa-check"></i><b>2.6</b> Next steps</a><ul>
<li class="chapter" data-level="2.6.1" data-path="counted.html"><a href="counted.html#finer-geographic-detail"><i class="fa fa-check"></i><b>2.6.1</b> Finer geographic detail</a></li>
<li class="chapter" data-level="2.6.2" data-path="counted.html"><a href="counted.html#testing-hypotheses"><i class="fa fa-check"></i><b>2.6.2</b> Testing hypotheses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dectab.html"><a href="dectab.html"><i class="fa fa-check"></i><b>3</b> The Financial Cash Flow Model: Python on Wall Street</a><ul>
<li class="chapter" data-level="3.1" data-path="dectab.html"><a href="dectab.html#case-description"><i class="fa fa-check"></i><b>3.1</b> Case Description</a></li>
<li class="chapter" data-level="3.2" data-path="dectab.html"><a href="dectab.html#xml-conversion"><i class="fa fa-check"></i><b>3.2</b> XML Conversion</a></li>
<li class="chapter" data-level="3.3" data-path="dectab.html"><a href="dectab.html#from-xml-to-plain-text"><i class="fa fa-check"></i><b>3.3</b> From XML to Plain Text</a></li>
<li class="chapter" data-level="3.4" data-path="dectab.html"><a href="dectab.html#proof-of-concept-summary-fico-statistics"><i class="fa fa-check"></i><b>3.4</b> Proof of Concept, Summary FICO Statistics</a></li>
<li class="chapter" data-level="3.5" data-path="dectab.html"><a href="dectab.html#the-cash-flow-model"><i class="fa fa-check"></i><b>3.5</b> The Cash Flow Model</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><i class="fa fa-check"></i><b>4</b> The Subprime Mortgage Crisis Unfolds in early 2007</a><ul>
<li class="chapter" data-level="4.1" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#case-description-1"><i class="fa fa-check"></i><b>4.1</b> Case Description</a></li>
<li class="chapter" data-level="4.2" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#data-wrangling"><i class="fa fa-check"></i><b>4.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="4.3" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#database-conversion"><i class="fa fa-check"></i><b>4.3</b> Database conversion</a></li>
<li class="chapter" data-level="4.4" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#preliminary-analysis-based-on-fico-scores"><i class="fa fa-check"></i><b>4.4</b> Preliminary analysis, based on FICO scores</a><ul>
<li class="chapter" data-level="4.4.1" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#ficos-importance"><i class="fa fa-check"></i><b>4.4.1</b> FICO’s importance</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#fico-scores-in-the-2006-loan-pool"><i class="fa fa-check"></i><b>4.4.2</b> FICO scores in the 2006 loan pool</a></li>
<li class="chapter" data-level="4.4.3" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#the-fico-scores-are-not-normally-distributed"><i class="fa fa-check"></i><b>4.4.3</b> The FICO scores are not normally distributed</a></li>
<li class="chapter" data-level="4.4.4" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#possible-strategies-to-deal-with-the-issues"><i class="fa fa-check"></i><b>4.4.4</b> Possible strategies to deal with the issues</a></li>
<li class="chapter" data-level="4.4.5" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#reduced-data-set"><i class="fa fa-check"></i><b>4.4.5</b> Reduced data set</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="the-subprime-mortgage-crisis-unfolds-in-early-2007.html"><a href="the-subprime-mortgage-crisis-unfolds-in-early-2007.html#next-steps-1"><i class="fa fa-check"></i><b>4.5</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html"><i class="fa fa-check"></i><b>5</b> The Enron Email Corpus</a><ul>
<li class="chapter" data-level="5.1" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#case-description-2"><i class="fa fa-check"></i><b>5.1</b> Case Description</a></li>
<li class="chapter" data-level="5.2" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#data-preparation"><i class="fa fa-check"></i><b>5.2</b> Data preparation</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#preparation"><i class="fa fa-check"></i><b>5.2.1</b> Preparation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#strategy-for-exploration"><i class="fa fa-check"></i><b>5.3</b> Strategy for exploration</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#dont-look-for-much-from-the-big-shots"><i class="fa fa-check"></i><b>5.3.1</b> Don’t look for much from the big shots</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#volume-is-not-evenly-distributed-among-users"><i class="fa fa-check"></i><b>5.3.2</b> Volume is not evenly distributed among users</a></li>
<li class="chapter" data-level="5.3.3" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#keywords-may-not-help-much"><i class="fa fa-check"></i><b>5.3.3</b> Keywords may not help much</a></li>
<li class="chapter" data-level="5.3.4" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#dont-neglect-time-series"><i class="fa fa-check"></i><b>5.3.4</b> Don’t neglect time series</a></li>
<li class="chapter" data-level="5.3.5" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#avoid-the-echo-chamber"><i class="fa fa-check"></i><b>5.3.5</b> Avoid the echo chamber</a></li>
<li class="chapter" data-level="5.3.6" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#the-real-value-proposition"><i class="fa fa-check"></i><b>5.3.6</b> The REAL value proposition</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#some-preliminary-results"><i class="fa fa-check"></i><b>5.4</b> Some preliminary results</a><ul>
<li class="chapter" data-level="5.4.1" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#unique-senders"><i class="fa fa-check"></i><b>5.4.1</b> Unique senders</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#unique-receivers"><i class="fa fa-check"></i><b>5.4.2</b> Unique receivers</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#senders-who-are-also-receivers"><i class="fa fa-check"></i><b>5.4.3</b> Senders who are also receivers</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#senderreceivers-with-enron-addresses"><i class="fa fa-check"></i><b>5.4.4</b> Sender/receivers with Enron addresses</a></li>
<li class="chapter" data-level="5.4.5" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#subject-line-words"><i class="fa fa-check"></i><b>5.4.5</b> Subject line words</a></li>
<li class="chapter" data-level="5.4.6" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#places-mentioned"><i class="fa fa-check"></i><b>5.4.6</b> Places mentioned</a></li>
<li class="chapter" data-level="5.4.7" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#periodicity"><i class="fa fa-check"></i><b>5.4.7</b> Periodicity</a></li>
<li class="chapter" data-level="5.4.8" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#social-networks"><i class="fa fa-check"></i><b>5.4.8</b> Social Networks</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-enron-email-corpus.html"><a href="the-enron-email-corpus.html#future-work"><i class="fa fa-check"></i><b>5.5</b> Future work</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="daycare.html"><a href="daycare.html"><i class="fa fa-check"></i><b>6</b> Daycare Costs and Unexamined Assumptions</a><ul>
<li class="chapter" data-level="6.1" data-path="daycare.html"><a href="daycare.html#case-description-3"><i class="fa fa-check"></i><b>6.1</b> Case Description</a></li>
<li class="chapter" data-level="6.2" data-path="daycare.html"><a href="daycare.html#with-the-right-metrics"><i class="fa fa-check"></i><b>6.2</b> With the right metrics</a></li>
<li class="chapter" data-level="6.3" data-path="daycare.html"><a href="daycare.html#takeaway"><i class="fa fa-check"></i><b>6.3</b> Takeaway</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html"><i class="fa fa-check"></i><b>7</b> Assorted Examples of Toolmaking</a><ul>
<li class="chapter" data-level="7.1" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#the-short-genome-file-day-to-day-python"><i class="fa fa-check"></i><b>7.1</b> The Short Genome File: Day-to-Day Python</a><ul>
<li class="chapter" data-level="7.1.1" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#case-description-4"><i class="fa fa-check"></i><b>7.1.1</b> Case Description</a></li>
<li class="chapter" data-level="7.1.2" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#conversion-problem"><i class="fa fa-check"></i><b>7.1.2</b> Conversion Problem</a></li>
<li class="chapter" data-level="7.1.3" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#everyday-solution"><i class="fa fa-check"></i><b>7.1.3</b> Everyday Solution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#hard-but-simple-parsing-yaml-files-in-haskell"><i class="fa fa-check"></i><b>7.2</b> Hard but simple – parsing YAML files in Haskell</a></li>
<li class="chapter" data-level="7.3" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#contextual-awareness"><i class="fa fa-check"></i><b>7.3</b> Contextual Awareness</a></li>
<li class="chapter" data-level="7.4" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#minimalism-throws-you-into-the-pool"><i class="fa fa-check"></i><b>7.4</b> Minimalism Throws You into the Pool</a></li>
<li class="chapter" data-level="7.5" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#parsing-system-date-strings-into-python-datetime-objects"><i class="fa fa-check"></i><b>7.5</b> Parsing system date strings into Python datetime objects</a></li>
<li class="chapter" data-level="7.6" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#combination-of-k-items-taken-n-at-a-time"><i class="fa fa-check"></i><b>7.6</b> Combination of k items, taken n at a time</a></li>
<li class="chapter" data-level="7.7" data-path="assorted-examples-of-toolmaking.html"><a href="assorted-examples-of-toolmaking.html#flexbison-to-compile-data-parser-for-june-20-2018-form"><i class="fa fa-check"></i><b>7.7</b> Flex/Bison to compile data parser for June 20, 2018 form</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-subprime-mortgage-crisis-unfolds-in-early-2007" class="section level1">
<h1><span class="header-section-number">4</span> The Subprime Mortgage Crisis Unfolds in early 2007</h1>
<p>Keywords: large database, MySQL, Python, data wrangling, data mining</p>
<div id="case-description-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Case Description</h2>
<p>Washington Mutual Bank originated subprime loans as one of its home loan mortgage types. The term <em>subprime</em> has always been hard to pin down precisely. Generally, though, they represented higher-interest rate loans to less creditworthy borrowers. In competition with other lenders, the risks types, such as the borrower’s debt-to-income ratio, the combined loan-to-value ratio (considering both the first and any second lien loan), the level of income and asset verification, and the purpose of the loan began to become <em>layered.</em> That is, the cumulative risk increased. And too much reliance, perhaps, was being placed on ever-increasing home values.</p>
<p>In early 2007, a marketing specialist from Washington Mutual Bank’s Wall Street subsidiary, called me to say that investors were complaining about the peformance of our subprime securities issued in 2006. I was the principal lawyer in-house dealing with mortgage backed securities, and he wanted to know what kinds of written materials he could provide.</p>
<p>I had some questions that had no ready answers:</p>
<ul>
<li>How did our pools of mortgage loans differ?</li>
<li>What do we mean by performance?</li>
</ul>
<p>We could begin, I suggested, by looking at the tape for the January 2006 deal, <a href="https://www.sec.gov/Archives/edgar/data/1119605/000114420406002461/v033798_fwp.htm">LBMLT 2006-1</a>, to see how the origination characteristics differed from competing deals. We could also pull the monthly report that showed last payment date, delinquency status and other data. He said that he’d try to get that together, but it wasn’t really his job.</p>
<p>This is the case that Donald Rumsfelt (<em>known knowns, known unknowns and unknown unknowns</em>) missed: <strong>unknown knowns,</strong> information we had that was scattered throughout the organization.</p>
<p>It became apparent that I wasn’t going to get any help dealing with my rising sense of unease that the company faced potential liabilities as a result of these transactions. I was senior enough to set my own priorities so I decided to assemble the data to see what I could make of it.</p>
</div>
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">4.2</span> Data Wrangling</h2>
<p>There were 14 transactions issued in 2006, all of which were accompanied by tapes similar to the <a href="https://www.sec.gov/Archives/edgar/data/1119605/000114420406002461/v033798_fwp.htm">LBMLT 2006-1</a> deal with origination data. I also looked at default data, from over 100 spreadsheets, many with manual changes, that had to be beaten into submission.</p>
<p>Fortunately the origination tapes, while wrapped in HTML, were tagged with</p>
<pre><code>&lt;pre&gt;payload&lt;/pre&gt; </code></pre>
<p>pairs, making their extraction easy. One of the typical tasks was converting dates into ISO form – from 3/6/2006, say, to 2006-03-06, for which I turned to Python.</p>
<pre><code>&quot;&quot;&quot;
function to convert dates into date objects

&quot;&quot;&quot;
from datetime import datetime
import re

def canonize_date(slashdate):
    &quot;&quot;&quot;convert date strings from 3/1/2009 to 2009-03-01&quot;&quot;&quot;
    dateString = re.compile(r&#39;(\d{1,2})/(\d{1,2})/(\d{4})&#39;) # match 3/1/2009
    dash = &#39;-&#39;
    parts = dateString.search(slashdate).groups()
    composed = parts[-1] + dash + parts[-3] + dash + parts[-2]
    return composed

def make_date(entry):
    &quot;&quot;&quot;
    Convert string in form 2011-10-25 to a date object
    &quot;&quot;&quot;
    return datetime.date(datetime.strptime(entry, &quot;%Y-%m-%d&quot;))
    </code></pre>
</div>
<div id="database-conversion" class="section level2">
<h2><span class="header-section-number">4.3</span> Database conversion</h2>
<p>There were too many records (nearly 125K) to work in memory, which lead me to create my first MySQL database.</p>
<pre><code>+---------+---------------+------+-----+---------+-------+
| Field   | Type          | Null | Key | Default | Extra |
+---------+---------------+------+-----+---------+-------+
| ctapeno | decimal(10,0) | YES  | MUL | NULL    |       |
| fpd     | date          | YES  |     | NULL    |       |
| obal    | decimal(10,0) | YES  |     | NULL    |       |
| ltype   | varchar(15)   | YES  |     | NULL    |       |
| cservno | decimal(10,0) | YES  |     | NULL    |       |
| st      | varchar(4)    | YES  |     | NULL    |       |
| odate   | date          | YES  |     | NULL    |       |
| margin  | decimal(10,0) | YES  |     | NULL    |       |
| oltv    | decimal(10,0) | YES  |     | NULL    |       |
| lien    | tinyint(4)    | YES  |     | NULL    |       |
| second  | decimal(10,0) | YES  |     | NULL    |       |
| pflag   | varchar(1)    | YES  |     | NULL    |       |
| pterm   | tinyint(4)    | YES  |     | NULL    |       |
| pmon    | tinyint(4)    | YES  |     | NULL    |       |
| grade   | varchar(5)    | YES  |     | NULL    |       |
| fico    | decimal(10,0) | YES  |     | NULL    |       |
| cbal    | varchar(1)    | YES  |     | NULL    |       |
| sbal    | decimal(10,0) | YES  |     | NULL    |       |
| deal    | varchar(15)   | YES  |     | NULL    |       |
| orate   | decimal(10,0) | YES  |     | NULL    |       |
| ptype   | varchar(10)   | YES  |     | NULL    |       |
| otype   | varchar(20)   | YES  |     | NULL    |       |
| dtype   | varchar(15)   | YES  |     | NULL    |       |
| purpose | varchar(25)   | YES  |     | NULL    |       |
| lg      | tinyint(4)    | YES  |     | NULL    |       |
| rterm   | smallint(6)   | YES  |     | NULL    |       |
| pmi     | varchar(1)    | YES  |     | NULL    |       |
| cdate   | date          | YES  |     | NULL    |       |
| mdate   | date          | YES  |     | NULL    |       |
| pexp    | date          | YES  |     | NULL    |       |
| pptype  | varchar(4)    | YES  |     | NULL    |       |
| icode   | varchar(4)    | YES  |     | NULL    |       |
| duedate | date          | YES  |     | NULL    |       |
| scap    | tinyint(4)    | YES  |     | NULL    |       |
| dti     | decimal(10,0) | YES  |     | NULL    |       |
| oterm   | smallint(6)   | YES  |     | NULL    |       |
| oservno | decimal(10,0) | YES  |     | NULL    |       |
| cltv    | decimal(10,0) | YES  |     | NULL    |       |
| rdate   | date          | YES  |     | NULL    |       |
| aterm   | smallint(6)   | YES  |     | NULL    |       |
| zip     | int(11)       | YES  |     | NULL    |       |
| city    | varchar(25)   | YES  |     | NULL    |       |
| status  | varchar(10)   | YES  |     | NULL    |       |
+---------+---------------+------+-----+---------+-------+
43 rows in set (0.00 sec)</code></pre>
<p>The data dictionary:</p>
<pre><code>+---------------------------+------------+-------------------------------------+
| tapefield                 | tablefield | desciption                          |
+---------------------------+------------+-------------------------------------+
| LOAN_NUMBER               | ctapeno    | serial number of loan on closing ta |
| FPDATE                    | fpd        | first schedule payment date after o |
| ORIGBAL                   | obal       | original note balance               |
| LOANTYPE                  | ltype      | loan type                           |
| SERVICING_LOAN_NUMBER     | servno     | customer account number             |
| STATE                     | st         | state where mortgaged property is l |
| FUNDDATE                  | odate      | date on which the mortage loan was  |
| MARGIN                    | margin     | &quot;for ARMs, the percentage added to  |
| OLTV                      | oltv       | original loan to value ratio        |
| LIEN                      | lien       | priority                            |
| SUBLIEN                   | second     | &quot;balance of sublien, if record is a |
| PREPAY_IND                | pflag      | whether loan has prepayment penalty |
| PREPAY_TERM               | pterm      | term of any prepayment penalty      |
| PREPAY_MNTH               | pmon       | number of months of prepayment pena |
| GRADE                     | grade      | credit grade of loan                |
| CALCFICO                  | cfico      | whether fico was calculated         |
| CALCBLN                   | cbal       | whether cut off date balance was ca |
| SCHDBAL                   | sbal       | schedule balance sold to deal       |
| SECURITY                  | deal       | securitization identifier           |
| ORIGRATE                  | orate      | note rate for initial payment       |
| PROPTYPEDESC              | ptype      | property type                       |
| OCCUPANCYDESC             | otype      | occupancy type                      |
| DOCTYPEDESC               | dtype      | documentation type                  |
| PURPOSEDESC               | purpose    | loan purpose                        |
| POOLGROUP                 | lg         | loan group                          |
| ORIG_CALCRTERM            | rterm      | calculated remaining months to matu |
| PMI                       | pmi        | whether MI is in effect             |
| DEAL_CLOSE_DATE           | cdate      | closing date for deal               |
| MTDATE                    | mdate      | matuity date for note               |
| PREPAY_EXP_DATE           | pexp       | expiration date of prepayment penal |
| PREPAY_RATE_CODE          | pptype     | prepayment penalty type             |
| INVESTOR_CODE             | icode      | investor code                       |
| DUEDATE                   | duedate    | date on which first payment due to  |
| SUBRATE_CAP               | scap       | subrate cap                         |
| DEBTRATIO                 | dti        | front-end debt-to-income ratio      |
| OTERM                     | oterm      | original term                       |
| ORIG_SERVICING_LOAN_NUMBE | oservno    | original servicing number           |
| PROSUPP_CLTV              | cltv       | combined LTV                        |
| ORIG_NRADATE              | rdate      | roll date                           |
| ATERM                     | aterm      | amortization term                   |
| ZIP                       | zip        | postal code                         |
| CITY                      | city       | address city                        |
| STATUS                    | status     | reserved                            |
+---------------------------+------------+-------------------------------------+
43 rows in set (0.00 sec)</code></pre>
<p>After creating these for each of the transactions, I combined them into a single file, used a supplemental zipcode lookup table to identify the metropolitan area (for possible use with the Case Shiller Index of Home Prices) and added fields for loan payment history.</p>
<p>The resulting table with the $25 billion in mortgage loans:</p>
<pre><code>+----------+-------------+
| count(*) | sum(obal)   |
+----------+-------------+
|   124645 | 25542466576 |
+----------+-------------+</code></pre>
</div>
<div id="preliminary-analysis-based-on-fico-scores" class="section level2">
<h2><span class="header-section-number">4.4</span> Preliminary analysis, based on FICO scores</h2>
<div id="ficos-importance" class="section level3">
<h3><span class="header-section-number">4.4.1</span> FICO’s importance</h3>
<p>In 1995, Freddie Mac advised lenders that it had found that consumer credit scores developed by Fair, Issac and Company, Inc. (<strong>FICO</strong> scores) strongly predicted the likelihood of default on mortgage loans. Freddie Mac’s communication is reproduced as Attachment 2 in testimony before the U.S. House Committee on Oversight and Government Reform, the <a href="https://democrats-oversight.house.gov/sites/democrats.oversight.house.gov/files/documents/Fannie%20Freddie%20Testimony%20of%20Edward%20Pinto%2012.9.08%20written%20submission%20Full.pdf">Pinto testimony</a>, beginning at page 28 of the pdf.</p>
<p>A traditional description of the limitations of credit score is similar to the following:</p>
<blockquote>
<p>Third-party credit reporting organizations provide credit scores as an aid to lenders in evaluating the creditworthiness of borrowers. Although different credit reporting organizations use different methodologies, higher credit scores indicate greater creditworthiness. Credit scores do not necessarily correspond to the probability of default over the life of the related mortgage loan because they reflect past credit history, rather than an assessment of future payment performance. In addition, the credit scores shown were collected from a variety of sources over a period of weeks, months or longer, and the credit scores do not necessarily reflect the credit scores that would be reported as of the date of this prospectus supplement. Credit scores also only indicate general consumer creditworthiness, and credit scores are not intended to specifically apply to mortgage debt. Therefore, credit scores should not be considered as an accurate predictor of the likelihood of repayment of the related mortgage loans.</p>
</blockquote>
<p><em>See</em> the <a href="https://goo.gl/uhX1Pc">credit disclosure</a> beginning on page S-18 by a Washington Mutual affiliate in 2002.</p>
<p>The rating agencies and buyers involved in residential mortgage backed securities, however, attached considerable importance to credit scores, generically referred to as FICOs. Therefore, the FICO composition was an obvious starting point.</p>
<p><img src="_main_files/figure-html/setup4-1.png" width="672" /></p>
</div>
<div id="fico-scores-in-the-2006-loan-pool" class="section level3">
<h3><span class="header-section-number">4.4.2</span> FICO scores in the 2006 loan pool</h3>
<p>FICO scores have a minimum value of 300, and a maximum value of 850. The summary statistics are:</p>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.0   600.0   631.0   631.9   665.0   821.0</code></pre>
<p>and the mode is 620. The minimum score represents loans without FICO scores:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">Table 4.1: </span>Number of no-FICO loans by deal
</caption>
<thead>
<tr>
<th style="text-align:left;">
deal
</th>
<th style="text-align:right;">
fico
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LBMLT 2006-4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL2
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Sixteen other loans had scores below 500:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-3">Table 4.2: </span>Number of low-FICO loans by deal
</caption>
<thead>
<tr>
<th style="text-align:left;">
deal
</th>
<th style="text-align:right;">
fico
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LBMLT 2006-1
</td>
<td style="text-align:right;">
498
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
491
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
492
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
470
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
487
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
465
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
481
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
493
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
482
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
498
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
494
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
473
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
496
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL3
</td>
<td style="text-align:right;">
498
</td>
</tr>
</tbody>
</table>
<p>The <em>cliffs</em> around 500 (below which only the small number of loans in the tables above are included), 600, 630 and 635 represent the cumulative segmentation of the pools to obtain favorable ratings. Not all deals followed this approach, however.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The variability among transactions suggest that <em>if</em> FICO scores have an influence on default rates, it may be necessary to stratify of otherwise transform the data to obtain useful results.</p>
</div>
<div id="the-fico-scores-are-not-normally-distributed" class="section level3">
<h3><span class="header-section-number">4.4.3</span> The FICO scores are not normally distributed</h3>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>As a group, FICO scores have <em>fat tails,</em> a trait that is present in each of the deals to some degree. There are more loans with very low FICO scores than you would expect if score were randomly distributed plus more loans with high score. We also see a dip in the 500-600 range (loans that may only have been originated due to compensating factors), which are fewer than the sub-500 FICO loans.</p>
<p>With variations, all the deals have similiar distributions. The variability of FICO scores makes their use as an independent variable in, say, regression analysis potentially problematic.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-4.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-5.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-6.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-7.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-8.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-9.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-10.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-11.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-12.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-13.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-6-14.png" width="672" /></p>
</div>
<div id="possible-strategies-to-deal-with-the-issues" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Possible strategies to deal with the issues</h3>
<p>Sampling the pool with a reasonably large number of observations will provide a well-behaved normal distribution, courtesy of the Central Limit Theorem. Alternatively, we can cluster based on the distance of each point from the trendline.</p>
<div id="possible-complication" class="section level4">
<h4><span class="header-section-number">4.4.4.1</span> Possible complication</h4>
<p>Between the time each deal was issued and the time that delinquency history was collated, almost a quarter of the loans dropped out:</p>
<pre><code>MariaDB [dlf]&gt; select count(*) from y6 where ctapeno not in (select ytemp.ctapeno from ytemp )

+----------+
| count(*) |
+----------+
|    28908 |
+----------+</code></pre>
<p>whether due to prepayment in full, repurchase by the seller for breach or default, foreclosure and sale.</p>
<p>The dropped loans appear similar to the original pool.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Summary statistics are similar.</p>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   482.0   587.0   628.0   626.7   664.0   818.0</code></pre>
<p>and the mode, 620, is identical.</p>
<p>Like the total pool, the dropouts were not normally distributed. Since none of the drops were no-FICO loans, the slopes differ, but the shape of the distribution appears to be remarkably similar to the total pool.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The distribution reports on each deal provide the cumulative number of defaulted loans that were liquidated. These were collected manually because there were only 15 files and I anticipated no future need to examine the reports.</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-10">Table 4.3: </span>Number of Liquidated Defaulted Loans Reported by the end of 2006
</caption>
<thead>
<tr>
<th style="text-align:left;">
deal
</th>
<th style="text-align:right;">
CIK
</th>
<th style="text-align:right;">
liquidated
</th>
<th style="text-align:left;">
reported
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LBMLT 2006-1
</td>
<td style="text-align:right;">
1,350,315
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-2
</td>
<td style="text-align:right;">
1,350,317
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-3
</td>
<td style="text-align:right;">
1,355,515
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-4
</td>
<td style="text-align:right;">
1,358,910
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-5
</td>
<td style="text-align:right;">
1,364,477
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-6
</td>
<td style="text-align:right;">
1,367,733
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-7
</td>
<td style="text-align:right;">
1,370,358
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-8
</td>
<td style="text-align:right;">
1,374,621
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-9
</td>
<td style="text-align:right;">
1,374,622
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-10
</td>
<td style="text-align:right;">
1,379,746
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-11
</td>
<td style="text-align:right;">
1,382,996
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
1,348,572
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL2
</td>
<td style="text-align:right;">
1,350,316
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
LBMLT 2006-WL3
</td>
<td style="text-align:right;">
1,350,318
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
</tbody>
</table>
<p>(The field “CIK” represents the EDGAR lookup key on the SEC data base; the field “reported” is whether a report was required to filed by the end of 2006.)</p>
</div>
<div id="decision-to-focus-on-loan-population-still-outstanding-in-early-2007" class="section level4">
<h4><span class="header-section-number">4.4.4.2</span> Decision to focus on loan population still outstanding in early 2007</h4>
<p>Only 81 loans of the 28908, or 0.28% of the dropped loans had defaulted and been liquidated by the end of 2006 reporting. On this basis, I decided to limit analysis to the remaining loans because FICO information about the dropped loans did not appear promising as a predictive factor in loan delinquency for the remaining loans.</p>
</div>
</div>
<div id="reduced-data-set" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Reduced data set</h3>
<div id="description" class="section level4">
<h4><span class="header-section-number">4.4.5.1</span> Description</h4>
<p>When the problem landed on my desk in early 2007, I had access to the delinquency history of the pool of loans remaining,</p>
<p>As a result, I turn to the survivors in a similar data base:</p>
<pre><code>MariaDB [dlf]&gt; describe y7;
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| city     | varchar(25)   | YES  |     | NULL    |       |
| cltv     | decimal(10,0) | YES  |     | NULL    |       |
| ctapeno  | decimal(10,0) | YES  |     | NULL    |       |
| deal     | varchar(25)   | YES  |     | NULL    |       |
| down     | int(11)       | YES  |     | NULL    |       |
| dti      | decimal(10,0) | YES  |     | NULL    |       |
| dtype    | varchar(25)   | YES  |     | NULL    |       |
| ebal     | decimal(10,0) | YES  |     | NULL    |       |
| fico     | decimal(10,0) | YES  |     | NULL    |       |
| fpd      | date          | YES  |     | NULL    |       |
| gainloss | decimal(10,0) | YES  |     | NULL    |       |
| grade    | varchar(5)    | YES  |     | NULL    |       |
| irate    | decimal(10,0) | YES  |     | NULL    |       |
| issuer   | varchar(10)   | YES  |     | NULL    |       |
| lat      | decimal(10,0) | YES  |     | NULL    |       |
| lien     | int(11)       | YES  |     | NULL    |       |
| liq      | decimal(10,0) | YES  |     | NULL    |       |
| lng      | decimal(10,0) | YES  |     | NULL    |       |
| lstatus  | int(11)       | YES  |     | NULL    |       |
| ltype    | varchar(25)   | YES  |     | NULL    |       |
| margin   | decimal(10,0) | YES  |     | NULL    |       |
| metro    | varchar(25)   | YES  |     | NULL    |       |
| nrate    | decimal(10,0) | YES  |     | NULL    |       |
| obal     | decimal(10,0) | YES  |     | NULL    |       |
| odate    | date          | YES  |     | NULL    |       |
| oltv     | decimal(10,0) | YES  |     | NULL    |       |
| orate    | decimal(10,0) | YES  |     | NULL    |       |
| oterm    | int(11)       | YES  |     | NULL    |       |
| payments | int(11)       | YES  |     | NULL    |       |
| pmiflag  | int(11)       | YES  |     | NULL    |       |
| pocode   | int(11)       | YES  |     | NULL    |       |
| pod      | date          | YES  |     | NULL    |       |
| ppp      | int(11)       | YES  |     | NULL    |       |
| ptd      | date          | YES  |     | NULL    |       |
| purpose  | varchar(25)   | YES  |     | NULL    |       |
| remit    | decimal(10,0) | YES  |     | NULL    |       |
| sbal     | decimal(10,0) | YES  |     | NULL    |       |
| servno   | decimal(10,0) | YES  |     | NULL    |       |
| sint     | decimal(10,0) | YES  |     | NULL    |       |
| sprin    | decimal(10,0) | YES  |     | NULL    |       |
| spymt    | decimal(10,0) | YES  |     | NULL    |       |
| st       | varchar(4)    | YES  |     | NULL    |       |
| zip      | int(11)       | YES  |     | NULL    |       |
| otype    | varchar(25)   | YES  |     | NULL    |       |
| rdate    | date          | YES  |     | NULL    |       |
| ptype    | varchar(15)   | YES  |     | NULL    |       |
| dptd     | int(7)        | YES  |     | NULL    |       |
| dfpd     | int(7)        | YES  |     | NULL    |       |
+----------+---------------+------+-----+---------+-------+
48 rows in set (0.00 sec)</code></pre>
<p>Some new fields will be important. As of the end of the first quarter 2007 <em>down</em> is the number of months that a loan has been delinquent. A value of down greater than 3 generally indicates a loan in foreclosure or a loan that has been foreclosed and is in the process of being sold.</p>
<p>The field <em>remit</em> is the past-month payment history encoded as a base10 number. The remittance reports contain a character field in the form “D110011011110” that shows whether a payment has been made (‘0’) or missed (‘1’) during the life of the loan. A little utility program converts the field to the equivalent binary number that captures that information.</p>
<pre><code> # convert a decimal (decimal, base 10) integer to a binary string (base 2)

def dec2bin(n):
    &#39;&#39;&#39;convert decimal integer n to binary string bStr&#39;&#39;&#39;
    bStr = &#39;&#39;
    if n &lt; 0:  raise ValueError(&quot;must be a positive integer&quot;)
    if n == 0: return &#39;0&#39;
    while n &gt; 0:
        bStr = str(n % 2) + bStr
        n = n &gt;&gt; 1
    return bStr

def int2bin(n, count=24):
    &quot;&quot;&quot;returns the binary of integer n, using count number of digits&quot;&quot;&quot;
    return &quot;&quot;.join([str((n &gt;&gt; y) &amp; 1) for y in range(count-1, -1, -1)])</code></pre>
<p>So, for example, if the remit field contains a value of 4198, the binary string representation, ‘1000001100110’, can be interpreted as follows: missed the payment 12 months before, made five payments, missed two, made two, missed two, made one.&quot;</p>
</div>
<div id="creating-a-performance-outcome-measure" class="section level4">
<h4><span class="header-section-number">4.4.5.2</span> Creating a performance outcome measure</h4>
<p>This provides a large menu of choices as to how to define <em>performance.</em> For example, if <em>remit = 0</em>, a loan has missed no payments in the preceding 12 months.</p>
<p>Unfortunately, there were few of those in the 2007 pool (the loans in securitizations issued in 2006 that remained in the pool at the end of the first quarter 2007, we will now call <strong>the pool</strong> and any subsets will be drawn from it), only 729 loans with perfect payment records.</p>
<p>A bigger problem is the large number of possible payment patterns over a 12-month period. It’s the permutation of two objects (pay/no pay) taken 12 times with replacement. This means that there are potentially 4096 different possibilities.</p>
<p>We <em>could</em> treat delinquencies as a continuous variable, but that creates useless distinctions. Some domain specific knowledge will help sort things out.</p>
<ol style="list-style-type: decimal">
<li><em>First payment delinquencies</em> in which the borrower fails to make the first payment due on a loan generally require the seller to repurchase the loan.</li>
<li><em>Single payment delinquencies</em> in which the borrower has missed a payment (after making the first payment due) but made it in the following month (called the <em>one time thirty test</em>) are not considered serious, if not repeated.</li>
<li><em>Two payment delinquencies</em> in which the as missed two payments (after making the first payment due) but made whether or not the payments were made in the third month (called the <em>two times thirty test</em>) are considered serious that it is customary for the seller to warrant that at the time of sale no such event has occurred.</li>
<li><em>Three payment delinquencies</em> are referred to as <em>defaults,</em> whether or not the borrower subsequently cures. As a rule, loans with a history of default that has been cured can be sold only at a discount.</li>
<li><em>Uncured defaults</em> are considered the most serious. Even if the payments missed are the three most recent and the borrower <em>may</em> repay in the following month, such a loan is classified as <em>nonperforming.</em></li>
<li><em>Loans in foreclosure</em> or <em>REO</em> (real estate owned, loans that have been foreclosed and awaiting sale) are also <em>nonperforming.</em></li>
</ol>
<p>This suggests a 3-factor performance metric:</p>
<ul>
<li>A: Performing: No more than two delinquencies in any reporting stratum</li>
<li>B: Troubled: Three or more delinquencies a reporting stratum but current on most recent reporting date</li>
<li>C: Non-performing: Uncured default on most recent reporting date</li>
</ul>
<p>The problem is thus a <em>classification</em> problem. Do FICO scores allow us to classify loans? The first task is to assign each loan its appropriate metric.</p>
</div>
<div id="implementing-the-metric" class="section level4">
<h4><span class="header-section-number">4.4.5.3</span> Implementing the metric</h4>
<p>From the 2007 pool database, we can pull the loan number, deal encoded remittance history and fico. With that we can decode the remittance history. Here’s a sample with only loans having FICO scores below 500.</p>
<pre><code>## Loading required package: binaryLogic</code></pre>
<pre><code>## 
## Attaching package: &#39;binaryLogic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     negate</code></pre>
<pre><code>## Loading required package: stringi</code></pre>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-13">Table 4.4: </span>2007 Q1 loans by loan number, remittance code and fico &lt; 500 (example
</caption>
<thead>
<tr>
<th style="text-align:right;">
ctapeno
</th>
<th style="text-align:left;">
deal
</th>
<th style="text-align:right;">
fico
</th>
<th style="text-align:left;">
repstr
</th>
<th style="text-align:right;">
reports
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
6,455,847
</td>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
497
</td>
<td style="text-align:left;">
111101110
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
6,535,544
</td>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
494
</td>
<td style="text-align:left;">
110110110
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
6,541,498
</td>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:left;">
101111100
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
6,448,789
</td>
<td style="text-align:left;">
LBMLT 2006-WL1
</td>
<td style="text-align:right;">
497
</td>
<td style="text-align:left;">
1011101110110000011
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:right;">
6,586,499
</td>
<td style="text-align:left;">
LBMLT 2006-WL2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
10100110111
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
6,573,788
</td>
<td style="text-align:left;">
LBMLT 2006-WL3
</td>
<td style="text-align:right;">
498
</td>
<td style="text-align:left;">
1010011010
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<p>In preparing a routine to parse the reports fields to classify the performance categories, I found a potential problem. The number of months reported is variable due to several factors: Some loans in the pool were recently originated, some were seasoned, and others intermediate. The distribution looks like the following histogram.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /> Observational data never organizes itself conveniently. Parsing the differing numbers of monthly reports is feasible, but I decided to limit the analysis of FICO and performance to the cohort of loans with 11-month reporting histories.</p>
<p>We can now add a column for performance category, and take a quick look at how those categories relate to FICO with the approximately 31219 loans with an 11-month payment history, about a third of the pool.</p>
<p>The boxplots show that the three categories of loans are broadly similar. The blow to orthodoxy is that the performing loans are composed of somewhat lower FICO scores than the non-performing and defaulted loans.</p>
<p>The distributions of the three categories show the same non-normal character as the original pools.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>(Category B omitted pending fixing of rendering bug in RStudio)</p>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="next-steps-1" class="section level2">
<h2><span class="header-section-number">4.5</span> Next steps</h2>
<p>I had planned on testing the association between FICO and defaults with logistic regression, but the similarities of FICO distributions among the three categories of loan performance make that an unpromising direction. So, the next line of attack will be to select among the other variables, starting with looking at their covariance with FICO.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dectab.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-enron-email-corpus.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
